import{parse as n}from"es-module-lexer";import e from"magic-string";import r from"@rollup/plugin-alias";import{basename as t,extname as o}from"path";import{normalizePath as u}from"@rollup/pluginutils";function a(n,e,r,t){return new(r||(r=Promise))((function(o,u){function a(n){try{l(t.next(n))}catch(n){u(n)}}function i(n){try{l(t.throw(n))}catch(n){u(n)}}function l(n){var e;n.done?o(n.value):(e=n.value,e instanceof r?e:new r((function(n){n(e)}))).then(a,i)}l((t=t.apply(n,e||[])).next())}))}function i(n,e){var r,t,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function i(i){return function(l){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u&&(u=0,i[0]&&(a=0)),a;)try{if(r=1,t&&(o=2&i[0]?t.return:i[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,t=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(n,a)}catch(n){i=[6,n],t=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}function l(n){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&n[e],t=0;if(r)return r.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&t>=n.length&&(n=void 0),{value:n&&n[t++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(n,e){var r="function"==typeof Symbol&&n[Symbol.iterator];if(!r)return n;var t,o,u=r.call(n),a=[];try{for(;(void 0===e||e-- >0)&&!(t=u.next()).done;)a.push(t.value)}catch(n){o={error:n}}finally{try{t&&!t.done&&(r=u.return)&&r.call(u)}finally{if(o)throw o.error}}return a}function s(n,e,r){if(r||2===arguments.length)for(var t,o=0,u=e.length;o<u;o++)!t&&o in e||(t||(t=Array.prototype.slice.call(e,0,o)),t[o]=e[o]);return n.concat(t||Array.prototype.slice.call(e))}"function"==typeof SuppressedError&&SuppressedError;var f=u(process.cwd()),d=new RegExp(f,"i"),p=new RegExp(f+"/(?!node_modules).*\\.[tj]s[x]?$","i"),h=/\?chunkName=([\w-.]*)/,v={main:"common",vendor:"vendor"},m=function(n){return t(n,o(n))},y=null,b={get:function(n){return y[n]},set:function(n){y=n}},w=null,g={get:function(n){return w[n]},set:function(n){w=n}},x=new RegExp("__","g"),k=new RegExp("\\.(css|less|sass|scss|styl|stylus|pcss|postcss)($|\\?)"),S=function(n){return k.test(n)},E=new Map;function N(n,e){var r=e.getModuleInfo,t=new Map,o=b.get(n),u=!!o,a=!d.test(n);if(u&&!S(n)&&C(n,r,t)||a)return o&&!E.has(o.name)&&E.set(o.name,!0),v.vendor;var i=h.exec(n);if(i)return O(i[1]);if(!(r(n).importers.length<2)){if(o){var l=s([],c(o.chunkNames),!1),f=l[0];return l.length>=2&&(f=o.name),E.has(f)&&(f=v.vendor),f||v.main}var p=g.get(n);if(p){var m=function(n){if(n.indexOf(v.main)>=0)return v.main;var e=n.filter((function(n){return n!==v.main}));switch(e.length){case 1:return e[0];case 2:return function(n){var e=c(n.sort((function(n,e){return n>e?1:n<e?-1:0})),2),r=e[0],t=e[1];return"shared/".concat(r,"/").concat(t)}(e);default:return v.main}}(s([],c(p.chunkNames),!1).filter(Boolean));return O(m)}}}function O(n){return n.replace(x,"/")}function C(n,e,r,t){if(void 0===t&&(t=[]),r.has(n))return r.get(n);if(t.includes(n))return r.set(n,!1),!1;var o=e(n);if(!o)return r.set(n,!1),!1;if(o.isEntry)return r.set(n,!0),!0;var u=o.importers.some((function(o){return C(o,e,r,t.concat(n))}));return r.set(n,u),u}function M(n){var e="function"==typeof n?n:void 0;return function(n,r){if(e){var t=e(n,r);if(t)return t}return N(n,r)}}var _=/(webpackC|c)hunkName:\s*["']([\w-/.]+)["']/,I=/node_modules\/((@[^/]+\/)?[^/]+)/g,R=function(n){for(var e="",r=null;r=I.exec(n);)e=r[1];return e},A=function(){var t,o,u=new Set,f=new Set;return{name:"manualNameChunksPlugin",apply:"build",load:function(n){return n.includes("node_modules")?u.add(n):d.test(n)&&f.add(n),null},configResolved:function(n){o=n},buildEnd:function(){var n=function(n,e){var r,t,o={};try{for(var u=l(n),a=u.next();!a.done;a=u.next()){var i=a.value;if(!o[i]){var c=j(i,e,o);o[i]={chunkNames:c}}}}catch(n){r={error:n}}finally{try{a&&!a.done&&(t=u.return)&&t.call(u)}finally{if(r)throw r.error}}return o}(f,this.getModuleInfo),e=function(n,e){var r,t,o={},u=function(n){var r,t;if(!o[n]){var u=R(n);o[n]={chunkNames:new Set([u]),name:u}}var a=e(n).importedIds,i=new Set(a),f=function(r){o[r]||(o[r]={chunkNames:new Set,name:R(r)}),s([],c(o[n].chunkNames),!1).forEach((function(n){return o[r].chunkNames.add(n)})),((e(r)||{}).importedIds||[]).forEach((function(n){return i.add(n)}))};try{for(var d=(r=void 0,l(i)),p=d.next();!p.done;p=d.next()){f(p.value)}}catch(n){r={error:n}}finally{try{p&&!p.done&&(t=d.return)&&t.call(d)}finally{if(r)throw r.error}}};try{for(var a=l(n),i=a.next();!i.done;i=a.next()){u(i.value)}}catch(n){r={error:n}}finally{try{i&&!i.done&&(t=a.return)&&t.call(a)}finally{if(r)throw r.error}}return o}(u,this.getModuleInfo);b.set(e),g.set(n)},transform:function(r,u){return a(this,void 0,void 0,(function(){var a,l,c,s,f,d,h,v,m,y,b,w,g,x,k;return i(this,(function(i){switch(i.label){case 0:if(!(p.test(u)&&_.test(r)))return[3,6];a=new e(r),l=n(r)[0],c=0,i.label=1;case 1:return c<l.length?(s=l[c],f=s.ss,d=s.se,h=s.s,v=s.e,m=s.n,y=r.slice(f,d),(b=_.exec(y))?(w=b[2].replace(/\//g,"__"),g=m,t?[4,t.resolveId.call(this,m,u)]:[3,3]):[3,4]):[3,5];case 2:(x=i.sent())&&(g=x.id),i.label=3;case 3:k='"'.concat(g,"?").concat("chunkName","=").concat(w,'"'),a=a.overwrite(h,v,k),i.label=4;case 4:return c++,[3,1];case 5:return[2,{code:a.toString(),map:o.build.sourcemap?a.generateMap({includeContent:!0,hires:!0}):null}];case 6:return[2]}}))}))},config:function(n){n.build||(n.build={}),n.build.rollupOptions||(n.build.rollupOptions={}),n.build.rollupOptions.output||(n.build.rollupOptions.output={});var e=n.build.rollupOptions,o=e.output;Array.isArray(o)?e.output=o.map((function(n){return n.manualChunks=M(n.manualChunks),n})):Object.assign(n.build.rollupOptions.output,{manualChunks:M(o.manualChunks)});var u=n.resolve&&n.resolve.alias;u&&(t=r({entries:u}))}}};function j(n,e,r){var t,o,u=[n],a=new Set;try{for(var i=l(u),c=i.next();!c.done;c=i.next()){var s=c.value,f=r[s];if(f)f.chunkNames.forEach((function(n){return a.add(n)}));else{var d=e(s),p=d.isEntry,h=d.importers;if(p)a.add(v.main);else if(0===h.length){var m=T(s);r[s]={chunkNames:new Set([m])},a.add(m)}else h.forEach((function(n){-1===u.indexOf(n)&&u.push(n)}))}}}catch(n){t={error:n}}finally{try{c&&!c.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}return a}var P=new Map;function T(n){var e=h.exec(n);if(e)return e[1];var r=m(n);if(P.has(r)){var t=P.get(r);return P.set(r,t+1),"".concat(r,"-").concat(t)}return P.set(r,1),r}export{A as manualChunksPlugin};
//# sourceMappingURL=vite-plugin-webpackchunkname.mjs.map
